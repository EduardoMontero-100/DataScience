CREATE TABLE IF NOT EXISTS 
`teco-prod-adam-85cc.data_lake_analytics.abt_capro_m`
(
  linea INT64,
  -- ft_prepago_m
  ofertas_all_u6_pagos_sum FLOAT64,
  ofertas_all_u5_pagos_sum FLOAT64,
  recargas_mdp_pagoelectronico_u6_pagos_cumsum FLOAT64,
  recargas_mdp_pagoelectronico_u5_pagos_cumsum FLOAT64,
  ofertas_all_u4_pagos_max FLOAT64,
  ofertas_all_u6_vigencia1_std FLOAT64,
  ofertas_all_u4_pagos_sum FLOAT64,
  ofertas_all_u3_pagos_avg FLOAT64,
  ofertas_all_u3_pagos_max FLOAT64,
  ofertas_all_u2_pagos_avg FLOAT64,
  recargas_rec_u1u2_pagos_ratio FLOAT64,
  ofertas_all_u6_vigencia1_avg FLOAT64,
  ofertas_all_u1_pagos_avg FLOAT64,
  recargas_rec_u1u3_pagos_diff FLOAT64,
  ofertas_all_u2_pagos_sum FLOAT64,
  recargas_rec_u1_arbu FLOAT64,
  recargas_rec_u1u6_pagos_diff FLOAT64,
  recargas_rec_u1u5_pagos_diff FLOAT64,
  recargas_rec_u3_pagos_sum FLOAT64,
  recargas_mdp_pagoelectronico_u1_pagos_sum FLOAT64,
  recargas_rec_u2_arbu FLOAT64,
  recargas_rec_u2_pagos_cumsum FLOAT64,
  recargas_mdp_pagoelectronico_u3_recargas_count FLOAT64,
  recargas_rec_u1u2_pagos_diff FLOAT64,
  recargas_rec_u5_arbu FLOAT64,
  recargas_mdp_pagoelectronico_u2_recargas_count FLOAT64,
  ofertas_all_u5_vigencia1_avg FLOAT64,
  ofertas_all_u4_vigencia1_std FLOAT64,
  recargas_rec_u4_arbu FLOAT64,
  recargas_mdp_pagoelectronico_u2_pagos_sum FLOAT64,
  recargas_rec_u6_pagos_sum FLOAT64,
  recargas_rec_u4_pagos_sum FLOAT64,
  recargas_mdp_pagoelectronico_u3_pagos_sum FLOAT64,
  recargas_rec_u5_pagos_cumsum FLOAT64,
  recargas_rec_u3_pagos_cumsum FLOAT64,
  recargas_rec_u4_pagos_cumsum FLOAT64,
  recargas_mdp_pagoelectronico_u4_pagos_sum FLOAT64,
  recargas_rec_u6_arbu FLOAT64,
  recargas_rec_u3_arbu FLOAT64,
  ofertas_all_u4_vigencia1_avg FLOAT64,
  recargas_rec_u6_pagos_cumsum FLOAT64,
  recargas_mdp_pagoelectronico_u4_recargas_count FLOAT64,
  recargas_mdp_pagoelectronico_u6_recargas_count FLOAT64,
  ofertas_all_u3_vigencia1_avg FLOAT64,
  -- stg_traficodatos_m
  uplink_mb_t_max FLOAT64,
  uplink_mb_sh4_std FLOAT64,
  uplink_mb_t_std FLOAT64,
  uplink_mb_s_std FLOAT64,
  downlink_mb_fs_max FLOAT64,
  uplink_mb_s_max FLOAT64,
  totat_traffic_mb_fs_max FLOAT64,
  totat_traffic_mb_s_max FLOAT64,
  uplink_mb_sh4_max FLOAT64,
  downlink_mb_sh4_std FLOAT64,
  uplink_mb_s_avg FLOAT64,
  traffic_4g_mb_sh4_std FLOAT64,
  downlink_mb_s_max FLOAT64,
  traffic_4g_mb_fs_max FLOAT64,
  uplink_mb_sh4_avg FLOAT64,
  totat_traffic_mb_t_max FLOAT64,
  totat_traffic_mb_sh4_max FLOAT64,
  downlink_mb_t_max FLOAT64,
  downlink_mb_s_std FLOAT64,
  totat_traffic_mb_fs_std FLOAT64,
  traffic_4g_mb_t_max FLOAT64,
  totat_traffic_mb_sh4_std FLOAT64,
  traffic_4g_mb_fs_std FLOAT64,
  downlink_mb_fs_std FLOAT64,
  traffic_4g_mb_s_max FLOAT64,
  downlink_mb_t_std FLOAT64,
  traffic_4g_mb_sh4_max FLOAT64,
  downlink_mb_sh4_max FLOAT64,
  downlink_mb_t_avg FLOAT64,
  downlink_mb_fs_avg FLOAT64,
  uplink_mb_t_avg FLOAT64,
  traffic_4g_mb_s_avg FLOAT64,
  downlink_mb_s_avg FLOAT64,
  traffic_4g_mb_sh4_avg FLOAT64,
  totat_traffic_mb_s_avg FLOAT64,
  totat_traffic_mb_t_avg FLOAT64,
  traffic_4g_mb_fs_min FLOAT64,
  totat_traffic_mb_s_std FLOAT64,
  totat_traffic_mb_fs_avg FLOAT64,
  downlink_mb_sh4_avg FLOAT64,
  traffic_3g_mb_sh4_max FLOAT64,
  traffic_4g_mb_s_min FLOAT64,
  traffic_4g_mb_fs_avg FLOAT64,
  totat_traffic_mb_sh4_avg FLOAT64,
  traffic_3g_mb_fs_std FLOAT64,
  traffic_4g_mb_t_std FLOAT64,
  totat_traffic_mb_t_std FLOAT64,
  traffic_3g_mb_fs_avg FLOAT64,
  traffic_3g_mb_s_std FLOAT64,
  traffic_3g_mb_fs_max FLOAT64,
  traffic_4g_mb_t_avg FLOAT64,
  traffic_3g_mb_s_avg FLOAT64,
  downlink_mb_fs_min FLOAT64,
  totat_traffic_mb_fs_min FLOAT64,
  traffic_3g_mb_t_max FLOAT64,
  uplink_mb_t_min FLOAT64,
  traffic_4g_mb_t_min FLOAT64,
  totat_traffic_mb_s_min FLOAT64,
  traffic_3g_mb_s_max FLOAT64,
  downlink_mb_s_min FLOAT64,
  traffic_3g_mb_t_avg FLOAT64,
  traffic_3g_mb_sh4_std FLOAT64,
  totat_traffic_mb_t_min FLOAT64,
  uplink_mb_s_min FLOAT64,
  traffic_3g_mb_t_std FLOAT64,
  -- periodo
  periodo INT64,
  -- prediccion
  score FLOAT64,
  bin INT64
)
PARTITION BY RANGE_BUCKET(periodo, GENERATE_ARRAY(201901, 207001, 1))
OPTIONS (labels=[("ambiente", "prod"),
                 ("etapa", "ml"), 
                 ("equipo", "dm"),
                 ("modelo", "capro"),
                 ("producto", "prepago"),
				 ("vertical", "movil"),
                 ("ml", "abt_capro")]);